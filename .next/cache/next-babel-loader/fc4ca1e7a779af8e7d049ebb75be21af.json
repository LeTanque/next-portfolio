{"ast":null,"code":"import _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime-corejs2/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/Users/tank/git/Portfolio/next-portfolio/components/threejs-render/SmokeContainer.jsx\";\nvar __jsx = React.createElement;\nimport * as THREE from 'three';\nimport React, { useState, useRef, useContext, useEffect, useCallback, useMemo } from 'react';\nimport { apply as extendSpring, useSpring, a, interpolate } from 'react-spring/three';\nimport { extend as extendThree, Canvas, useFrame, useThree } from 'react-three-fiber';\nimport styled from 'styled-components';\nimport data from '../../resources/data'; // Import and register postprocessing classes as three-native-elements\n\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer';\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass';\nimport { GlitchPass } from '../../resources/postprocessing/GlitchPass';\nextendSpring({\n  EffectComposer,\n  RenderPass,\n  GlitchPass\n});\nextendThree({\n  EffectComposer,\n  RenderPass,\n  GlitchPass\n});\n/** This component loads an image and projects it onto a plane */\n\nfunction Image(_ref) {\n  let {\n    url,\n    opacity,\n    scale\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"url\", \"opacity\", \"scale\"]);\n\n  const texture = useMemo(() => new THREE.TextureLoader().load(url), [url]);\n  const {\n    0: hovered,\n    1: setHover\n  } = useState(false);\n  const hover = useCallback(() => setHover(true), []);\n  const unhover = useCallback(() => setHover(false), []);\n  const {\n    factor\n  } = useSpring({\n    factor: hovered ? 1.1 : 1\n  });\n  return __jsx(a.mesh, _extends({}, props, {\n    onPointerOver: hover,\n    onPointerOut: unhover,\n    scale: factor.interpolate(f => [scale * f, scale * f, 1]),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 24\n    },\n    __self: this\n  }), __jsx(\"planeBufferGeometry\", {\n    attach: \"geometry\",\n    args: [5, 5],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29\n    },\n    __self: this\n  }), __jsx(a.meshLambertMaterial, {\n    attach: \"material\",\n    transparent: true,\n    opacity: opacity,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30\n    },\n    __self: this\n  }, __jsx(\"primitive\", {\n    attach: \"map\",\n    object: texture,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31\n    },\n    __self: this\n  })));\n}\n/** This renders text via canvas and projects it as a sprite */\n\n\nfunction Text({\n  children,\n  position,\n  opacity,\n  color = 'white',\n  fontSize = 410\n}) {\n  const {\n    camera,\n    size: {\n      width,\n      height\n    },\n    viewport: {\n      width: viewportWidth,\n      height: viewportHeight\n    }\n  } = useThree();\n  const scale = viewportWidth > viewportHeight ? viewportWidth : viewportHeight;\n  const canvas = useMemo(() => {\n    const canvas = document.createElement('canvas');\n    canvas.width = canvas.height = 2048;\n    const context = canvas.getContext('2d');\n    context.font = `bold ${fontSize}px -apple-system, BlinkMacSystemFont, avenir next, avenir, helvetica neue, helvetica, ubuntu, roboto, noto, segoe ui, arial, sans-serif`;\n    context.textAlign = 'center';\n    context.textBaseline = 'middle';\n    context.fillStyle = color;\n    context.fillText(children, 1024, 1024 - 410 / 2);\n    return canvas;\n  }, [children, width, height]);\n  return __jsx(a.sprite, {\n    scale: [scale, scale, 1],\n    position: position,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, __jsx(a.spriteMaterial, {\n    attach: \"material\",\n    transparent: true,\n    opacity: opacity,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  }, __jsx(\"canvasTexture\", {\n    attach: \"map\",\n    image: canvas,\n    premultiplyAlpha: true,\n    onUpdate: s => s.needsUpdate = true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  })));\n}\n/** This component creates a fullscreen colored plane */\n\n\nfunction Background({\n  color\n}) {\n  const {\n    size,\n    viewport\n  } = useThree();\n  console.log(viewport);\n  return __jsx(\"mesh\", {\n    scale: [viewport.width, viewport.height, 1],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }, __jsx(\"planeBufferGeometry\", {\n    attach: \"geometry\",\n    args: [1, 1],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }), __jsx(a.meshBasicMaterial, {\n    attach: \"material\",\n    color: color,\n    depthTest: false,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }));\n}\n/** This component rotates a bunch of stars */\n\n\nfunction Stars({\n  position\n}) {\n  let group = useRef();\n  let theta = 0;\n  useFrame(() => {\n    const r = 5 * Math.sin(THREE.Math.degToRad(theta += 0.01));\n    const s = Math.cos(THREE.Math.degToRad(theta * 2));\n    group.current.rotation.set(r, r, r);\n    group.current.scale.set(s, s, s);\n  });\n  const {\n    0: geo,\n    1: mat,\n    2: coords\n  } = useMemo(() => {\n    const geo = new THREE.SphereBufferGeometry(1, 10, 10);\n    const mat = new THREE.MeshBasicMaterial({\n      color: new THREE.Color('peachpuff')\n    });\n    const coords = new Array(1000).fill().map(i => [Math.random() * 800 - 400, Math.random() * 800 - 400, Math.random() * 800 - 400]);\n    return [geo, mat, coords];\n  }, []);\n  return __jsx(a.group, {\n    ref: group,\n    position: position,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, coords.map(([p1, p2, p3], i) => __jsx(\"mesh\", {\n    key: i,\n    geometry: geo,\n    material: mat,\n    position: [p1, p2, p3],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  })));\n}\n/** This component creates a glitch effect */\n\n\nconst Effects = React.memo(({\n  factor\n}) => {\n  const {\n    gl,\n    scene,\n    camera,\n    size\n  } = useThree();\n  const composer = useRef();\n  useEffect(() => void composer.current.setSize(size.width, size.height), [size]); // This takes over as the main render-loop (when 2nd arg is set to true)\n\n  useFrame(() => composer.current.render(), 1);\n  return __jsx(\"effectComposer\", {\n    ref: composer,\n    args: [gl],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, __jsx(\"renderPass\", {\n    attachArray: \"passes\",\n    args: [scene, camera],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }), __jsx(a.glitchPass, {\n    attachArray: \"passes\",\n    renderToScreen: true,\n    factor: factor,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }));\n});\n/** This component creates a bunch of parallaxed images */\n\nfunction Images({\n  top,\n  mouse,\n  scrollMax\n}) {\n  return data.map(([url, x, y, factor, z, scale], index) => __jsx(Image, {\n    key: index,\n    url: url,\n    scale: scale,\n    opacity: top.interpolate([0, 500], [0, 1]),\n    position: interpolate([top, mouse], (top, mouse) => [-mouse[0] * factor / 50000 + x, mouse[1] * factor / 50000 + y * 1.15 + top * factor / scrollMax * 2, z + top / 2000]),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }));\n}\n/** This component maintains the scene */\n\n\nfunction Scene({\n  top,\n  mouse\n}) {\n  const {\n    size\n  } = useThree();\n  const scrollMax = size.height * 4.5;\n  return __jsx(React.Fragment, null, __jsx(a.spotLight, {\n    intensity: 1.2,\n    color: \"white\",\n    position: mouse.interpolate((x, y) => [x / 100, -y / 100, 6.5]),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }), __jsx(Effects, {\n    factor: top.interpolate([0, 150], [1, 0]),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }), __jsx(Background, {\n    color: top.interpolate([0, scrollMax * 0.25, scrollMax * 0.8, scrollMax], ['#27282F', '#247BA0', '#70C1B3', '#f8f3f1']),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }), __jsx(Stars, {\n    position: top.interpolate(top => [0, -1 + top / 20, 0]),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }), __jsx(Images, {\n    top: top,\n    mouse: mouse,\n    scrollMax: scrollMax,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }), __jsx(Text, {\n    opacity: top.interpolate([0, 200], [1, 0]),\n    position: top.interpolate(top => [0, -1 + top / 200, 0]),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, \"lorem\"), __jsx(Text, {\n    position: top.interpolate(top => [0, -20 + top * 10 / scrollMax * 2, 0]),\n    color: \"black\",\n    fontSize: 150,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, \"Ipsum\"));\n}\n/** Main component */\n\n\nexport default function Main() {\n  // This tiny spring right here controlls all(!) the animations, one for scroll, the other for mouse movement ...\n  const [{\n    top,\n    mouse\n  }, set] = useSpring(() => ({\n    top: 0,\n    mouse: [0, 0]\n  }));\n  const onMouseMove = useCallback(({\n    clientX: x,\n    clientY: y\n  }) => set({\n    mouse: [x - window.innerWidth / 2, y - window.innerHeight / 2]\n  }), []);\n  const onScroll = useCallback(e => set({\n    top: e.target.scrollTop\n  }), []);\n  const {\n    0: events,\n    1: setEvents\n  } = useState({});\n  return __jsx(React.Fragment, null, __jsx(Canvas, {\n    className: \"canvas\",\n    onCreated: ({\n      events\n    }) => setEvents(events),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, __jsx(Scene, {\n    top: top,\n    mouse: mouse,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  })), __jsx(Container, _extends({\n    onScroll: onScroll,\n    onMouseMove: onMouseMove\n  }, events, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    style: {\n      height: '525vh'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  })));\n}\nconst Container = styled.div`\n  position: absolute;\n  overflow: auto;\n  top: 0px;\n  width: 100%;\n  height: 100vh;\n  font-size: 20em;\n  font-weight: 800;\n  line-height: 0.9em;\n`;","map":{"version":3,"sources":["/Users/tank/git/Portfolio/next-portfolio/components/threejs-render/SmokeContainer.jsx"],"names":["THREE","React","useState","useRef","useContext","useEffect","useCallback","useMemo","apply","extendSpring","useSpring","a","interpolate","extend","extendThree","Canvas","useFrame","useThree","styled","data","EffectComposer","RenderPass","GlitchPass","Image","url","opacity","scale","props","texture","TextureLoader","load","hovered","setHover","hover","unhover","factor","f","Text","children","position","color","fontSize","camera","size","width","height","viewport","viewportWidth","viewportHeight","canvas","document","createElement","context","getContext","font","textAlign","textBaseline","fillStyle","fillText","s","needsUpdate","Background","console","log","Stars","group","theta","r","Math","sin","degToRad","cos","current","rotation","set","geo","mat","coords","SphereBufferGeometry","MeshBasicMaterial","Color","Array","fill","map","i","random","p1","p2","p3","Effects","memo","gl","scene","composer","setSize","render","Images","top","mouse","scrollMax","x","y","z","index","Scene","Main","onMouseMove","clientX","clientY","window","innerWidth","innerHeight","onScroll","e","target","scrollTop","events","setEvents","Container","div"],"mappings":"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","sourcesContent":["import * as THREE from 'three'\nimport React, { useState, useRef, useContext, useEffect, useCallback, useMemo } from 'react'\nimport { apply as extendSpring, useSpring, a, interpolate } from 'react-spring/three'\nimport { extend as extendThree, Canvas, useFrame, useThree } from 'react-three-fiber'\nimport styled from 'styled-components'\nimport data from '../../resources/data'\n\n// Import and register postprocessing classes as three-native-elements\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer'\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass'\nimport { GlitchPass } from '../../resources/postprocessing/GlitchPass'\n\nextendSpring({ EffectComposer, RenderPass, GlitchPass })\nextendThree({ EffectComposer, RenderPass, GlitchPass })\n\n/** This component loads an image and projects it onto a plane */\nfunction Image({ url, opacity, scale, ...props }) {\n  const texture = useMemo(() => new THREE.TextureLoader().load(url), [url])\n  const [hovered, setHover] = useState(false)\n  const hover = useCallback(() => setHover(true), [])\n  const unhover = useCallback(() => setHover(false), [])\n  const { factor } = useSpring({ factor: hovered ? 1.1 : 1 })\n  return (\n    <a.mesh\n      {...props}\n      onPointerOver={hover}\n      onPointerOut={unhover}\n      scale={factor.interpolate(f => [scale * f, scale * f, 1])}>\n      <planeBufferGeometry attach=\"geometry\" args={[5, 5]} />\n      <a.meshLambertMaterial attach=\"material\" transparent opacity={opacity}>\n        <primitive attach=\"map\" object={texture} />\n      </a.meshLambertMaterial>\n    </a.mesh>\n  )\n}\n\n/** This renders text via canvas and projects it as a sprite */\nfunction Text({ children, position, opacity, color = 'white', fontSize = 410 }) {\n  const {\n    camera,\n    size: { width, height },\n    viewport: { width: viewportWidth, height: viewportHeight },\n  } = useThree()\n  const scale = viewportWidth > viewportHeight ? viewportWidth : viewportHeight\n  const canvas = useMemo(() => {\n    const canvas = document.createElement('canvas')\n    canvas.width = canvas.height = 2048\n    const context = canvas.getContext('2d')\n    context.font = `bold ${fontSize}px -apple-system, BlinkMacSystemFont, avenir next, avenir, helvetica neue, helvetica, ubuntu, roboto, noto, segoe ui, arial, sans-serif`\n    context.textAlign = 'center'\n    context.textBaseline = 'middle'\n    context.fillStyle = color\n    context.fillText(children, 1024, 1024 - 410 / 2)\n    return canvas\n  }, [children, width, height])\n  return (\n    <a.sprite scale={[scale, scale, 1]} position={position}>\n      <a.spriteMaterial attach=\"material\" transparent opacity={opacity}>\n        <canvasTexture attach=\"map\" image={canvas} premultiplyAlpha onUpdate={s => (s.needsUpdate = true)} />\n      </a.spriteMaterial>\n    </a.sprite>\n  )\n}\n\n/** This component creates a fullscreen colored plane */\nfunction Background({ color }) {\n  const { size, viewport } = useThree()\n  console.log(viewport)\n  return (\n    <mesh scale={[viewport.width, viewport.height, 1]}>\n      <planeBufferGeometry attach=\"geometry\" args={[1, 1]} />\n      <a.meshBasicMaterial attach=\"material\" color={color} depthTest={false} />\n    </mesh>\n  )\n}\n\n/** This component rotates a bunch of stars */\nfunction Stars({ position }) {\n  let group = useRef()\n  let theta = 0\n  useFrame(() => {\n    const r = 5 * Math.sin(THREE.Math.degToRad((theta += 0.01)))\n    const s = Math.cos(THREE.Math.degToRad(theta * 2))\n    group.current.rotation.set(r, r, r)\n    group.current.scale.set(s, s, s)\n  })\n  const [geo, mat, coords] = useMemo(() => {\n    const geo = new THREE.SphereBufferGeometry(1, 10, 10)\n    const mat = new THREE.MeshBasicMaterial({ color: new THREE.Color('peachpuff') })\n    const coords = new Array(1000)\n      .fill()\n      .map(i => [Math.random() * 800 - 400, Math.random() * 800 - 400, Math.random() * 800 - 400])\n    return [geo, mat, coords]\n  }, [])\n  return (\n    <a.group ref={group} position={position}>\n      {coords.map(([p1, p2, p3], i) => (\n        <mesh key={i} geometry={geo} material={mat} position={[p1, p2, p3]} />\n      ))}\n    </a.group>\n  )\n}\n\n/** This component creates a glitch effect */\nconst Effects = React.memo(({ factor }) => {\n  const { gl, scene, camera, size } = useThree()\n  const composer = useRef()\n  useEffect(() => void composer.current.setSize(size.width, size.height), [size])\n  // This takes over as the main render-loop (when 2nd arg is set to true)\n  useFrame(() => composer.current.render(), 1)\n  return (\n    <effectComposer ref={composer} args={[gl]}>\n      <renderPass attachArray=\"passes\" args={[scene, camera]} />\n      <a.glitchPass attachArray=\"passes\" renderToScreen factor={factor} />\n    </effectComposer>\n  )\n})\n\n/** This component creates a bunch of parallaxed images */\nfunction Images({ top, mouse, scrollMax }) {\n  return data.map(([url, x, y, factor, z, scale], index) => (\n    <Image\n      key={index}\n      url={url}\n      scale={scale}\n      opacity={top.interpolate([0, 500], [0, 1])}\n      position={interpolate([top, mouse], (top, mouse) => [\n        (-mouse[0] * factor) / 50000 + x,\n        (mouse[1] * factor) / 50000 + y * 1.15 + ((top * factor) / scrollMax) * 2,\n        z + top / 2000,\n      ])}\n    />\n  ))\n}\n\n/** This component maintains the scene */\nfunction Scene({ top, mouse }) {\n  const { size } = useThree()\n  const scrollMax = size.height * 4.5\n  return (\n    <>\n      <a.spotLight intensity={1.2} color=\"white\" position={mouse.interpolate((x, y) => [x / 100, -y / 100, 6.5])} />\n      <Effects factor={top.interpolate([0, 150], [1, 0])} />\n      <Background\n        color={top.interpolate(\n          [0, scrollMax * 0.25, scrollMax * 0.8, scrollMax],\n          ['#27282F', '#247BA0', '#70C1B3', '#f8f3f1']\n        )}\n      />\n      <Stars position={top.interpolate(top => [0, -1 + top / 20, 0])} />\n      <Images top={top} mouse={mouse} scrollMax={scrollMax} />\n      <Text opacity={top.interpolate([0, 200], [1, 0])} position={top.interpolate(top => [0, -1 + top / 200, 0])}>\n        lorem\n      </Text>\n      <Text position={top.interpolate(top => [0, -20 + ((top * 10) / scrollMax) * 2, 0])} color=\"black\" fontSize={150}>\n        Ipsum\n      </Text>\n    </>\n  )\n}\n\n/** Main component */\nexport default function Main() {\n  // This tiny spring right here controlls all(!) the animations, one for scroll, the other for mouse movement ...\n  const [{ top, mouse }, set] = useSpring(() => ({ top: 0, mouse: [0, 0] }))\n  const onMouseMove = useCallback(\n    ({ clientX: x, clientY: y }) => set({ mouse: [x - window.innerWidth / 2, y - window.innerHeight / 2] }),\n    []\n  )\n  const onScroll = useCallback(e => set({ top: e.target.scrollTop }), [])\n  const [events, setEvents] = useState({})\n  return (\n    <>\n      <Canvas className=\"canvas\" onCreated={({ events }) => setEvents(events)}>\n        <Scene top={top} mouse={mouse} />\n      </Canvas>\n      <Container onScroll={onScroll} onMouseMove={onMouseMove} {...events}>\n        <div style={{ height: '525vh' }} />\n      </Container>\n    </>\n  )\n}\n\nconst Container = styled.div`\n  position: absolute;\n  overflow: auto;\n  top: 0px;\n  width: 100%;\n  height: 100vh;\n  font-size: 20em;\n  font-weight: 800;\n  line-height: 0.9em;\n`"]},"metadata":{},"sourceType":"module"}